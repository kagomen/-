- メール送信

  1. MUA（メールユーザエージェント）から、SMTP-Auth で MSA（メールサーバ）へ送信
  1. MSA から MTA へ TCP25 で送信
  1. MTA から MTA へ SMTP で送信

- メール受信

## DNS

- MX レコード

  - 電子メール送信先のサーバ情報

- TXT レコード

  - ホスト名に関連づけるテキスト情報を定義する
  - （独自ドメインで送信を許可するメールサーバを指定する）SPF レコードはここに記載する

- SMTP(メール送信プロトコル)

  - 送信者(クライアント)がメールサーバへメールを送信する
  - 送信者のメールサーバから受信者のメールサーバへ転送する
  - ウェルノウンポート 25 番（もしくはサブミッションポートの 587 番）が使用される

- POP3(メール受信プロトコル)

  - 受信者(クライアント)がメールサーバのメールボックスからメールデータをダウンロードする
  - ダウンロード時にメールサーバからメールが削除される（サーバではなく PC で管理する）
    - 複数の端末でメールデータを共有することが不可能
    - PC 側でバックアップをとる必要がある
  - ウェルノウンポート 110 番が使用される

- IMAP4(メール受信プロトコル)

  - POP3 と異なり、メールデータをメールサーバで管理する
  - 複数の端末でメールデータを共有できる
  - メールサーバに負荷がかかりやすい

- Web メール

  - HTTP 通信でメールの送受信を行う

- SMTP での流れ

  1. 送信先のメールアドレスの@以降のドメイン名を元に、DNS に送信先のメールサーバ名(MX レコード)を問い合わせる
  1. メールサーバ名の IP アドレス(A レコード)を DNS に問い合わせる
  1. IP アドレスにメールデータを送信する

- 送信元ドメイン認証技術

  - 迷惑メールやスパムメールを防止する

  - SFP
    - IP アドレスで認証する
    - 受信側のメールサーバが、送信元のメールサーバが正規のサーバかどうかを DNS に問い合わせる
  - DKIM
    - メールサーバの署名で認証する
    - メールに電子署名(秘密鍵)を添付し、受信側のメールサーバが DNS に対して鍵を照合し、メールデータを受け取る
  - DMARK

- OP25B（OutBound Port 25 Blocking）

  - 自分の ISP メールサーバを経由せず、他の ISP の 25 万ポートを利用しようとした場合、ISP 内部でブロックする

- サブミッションポート(578 番)

  - ユーザ認証(SMTP Auth)をすることで、別のメールサーバの 587 番からメール送信ができるようになる

- 参考
  - https://www.youtube.com/watch?v=a8o2vhVWK_k
  - https://www.youtube.com/watch?v=RbygSd1f0dk
  - https://www.youtube.com/watch?v=3iZ4Sjg9LsY
